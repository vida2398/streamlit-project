import streamlit as st
import pandas as pd
import seaborn as sns
import numpy as np
import matplotlib.pyplot as plt
import plotly.express as px # ì¸ë±ìŠ¤ ì¸ì§€ ëª»í•¨..! as_index = False
import folium
from streamlit_folium import st_folium #pip install streamlit pydeck folium streamlit-folium

def show_main():
    st.header("ìŠ¤ë§ˆíŠ¸í° ê³¼ì˜ì¡´ í˜„ìƒ: íŠ¹ì´ì ì´ ì˜¨ ì‹œê¸°ëŠ”?")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.write('"ëˆˆ ëœ¨ìë§ˆì í™•ì¸"...ìŠ¤ë§ˆíŠ¸í° ê³¼ì˜ì¡´ ìœ„í—˜êµ°, ì•„ë™ì¸µë„ ì˜ˆì™¸ ì—†ë‹¤? ì¶œì²˜ : KTV News 2025ë…„ 3ì›” 28ì¼')
    st.video("https://www.youtube.com/watch?v=UYGZKnNmsuM")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.subheader("â“í™•ì¸ í•´ ë³¼ ì‚¬í•­")
    st.markdown("""
        - ìŠ¤ë§ˆíŠ¸í° ê³¼ì˜ì¡´ë„ê°€ ë†’ì•„ì§„ ì´ìœ  -> ê°€ì„¤: ì½”ë¡œë‚˜ ì‹œê¸°ì˜ ì˜¤í”„ë¼ì¸ í™œë™ì´ ì¤„ì—ˆê¸° ë•Œë¬¸ì¼ ê²ƒì´ë‹¤ -> ì½”ë¡œë‚˜ ì‹œê¸°ì˜ ë°ì´í„° í™•ì¸
        - ìœ„ì˜ ë‰´ìŠ¤ ì •ë³´ ì¤‘ ê³¼ì˜ì¡´ ì´ìš©ìì™€ ì¼ë°˜ ì´ìš©ìì˜ ì£¼ìš” ì´ìš© ì½˜í…ì¸  ìœ í˜•ì´ ë‹¤ë¥´ë‹¤ëŠ” ìë£Œ -> ì½˜í…ì¸  ìœ í˜•ë³„ íŠ¸ë˜í”½ ë°ì´í„° ë¶„í¬ í™•ì¸
         """)
    st.image("news.jpg")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.subheader("ğŸ‘ˆğŸ‘ˆğŸ‘ˆ ë°ì´í„°ë¥¼ í™•ì¸ í•˜ê¸° ì „ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´…ì‹œë‹¤")


def show_anl():
    st.header("ê³¼ì˜ì¡´ ìœ„í—˜ë„ ë¶„ì„")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    smtph = pd.read_csv("smtphone.csv")
    st.write("## ìŠ¤ë§ˆíŠ¸í° ì˜ì¡´ë„ ë°ì´í„°ì…ë‹ˆë‹¤.")
    selectedAge = st.selectbox("ì—°ë ¹ì„ ì„ íƒí•˜ì‹œì˜¤", smtph['ì—°ë ¹ëŒ€ë³„'].unique().tolist())
    result = smtph.query("ì—°ë ¹ëŒ€ë³„ == @selectedAge")

    c1 = px.bar(data_frame=result, x="ì‹œì ", y ="ì˜ì¡´ë„")
    st.plotly_chart(c1)

    c2 = px.bar(data_frame=smtph, x="ì‹œì ", y="ì˜ì¡´ë„", color="ì—°ë ¹ëŒ€ë³„", barmode="group")
    st.plotly_chart(c2)
    st.write("## ğŸ’¡ì•Œìˆ˜ ìˆëŠ” ì§€ì  2ê°€ì§€")
    st.write("### 1. íŠ¹ì • ì—°ë ¹ë§Œ ì˜ì¡´ë„ê°€ ë†’ì•„ì§„ ê±´ ì•„ë‹ˆë‹¤")
    st.write("### 2. ì²­ì†Œë…„ì„ ì œì™¸í•˜ê³  ëª¨ë‘ 2021ë…„ì— ì˜ì¡´ë„ê°€ ê°€ì¥ ë†’ì•˜ë‹¤")
    st.write("### ğŸ‘‰ ê°€ì„¤: ì½”ë¡œë‚˜ ì‹œê¸°ì— ì‹¤ì—…ë¥ ì´ ëŠ˜ì–´ ì˜ì¡´ë„ê°€ ë†’ì•„ì§„ ê²ƒì´ë‹¤.")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.write("## ì›”ë³„ ì‹¤ì—…ë¥  ë°ì´í„°ë¥¼ ì‚´í´ë³´ì")
    fired = pd.read_csv("unemployment.csv")
    c3 = px.bar(data_frame=fired, x="date", y ="rate")
    st.plotly_chart(c3)

    

    st.subheader("ì‹¤ì—…ë¥ ì´ ë†’ì•˜ë” ì‹œê¸°ì˜ ìš”ì¸ì€?")
    st.write('í•œì˜ˆê²½ / ê°•ê³„ë§Œ ê¸°ì. "1ì›” ì‹¤ì—…ë¥  5%ëŒ€ë¡œ ê»‘ì¶©â€¦ì²­ë…„ì‹¤ì—…ë¥ ì€ 9.3%" ë§¤ì¼ê²½ì œ, 2010ë…„ 02ì›” 11ì¼')
    st.write("https://www.mk.co.kr/news/economy/4684439")
    st.markdown("*ì´ì²˜ëŸ¼ ì‹¤ì—…ìê°€ ê¸‰ì¦í•œ ê²ƒì€ ì‹¤ì§ì ì¦ê°€ë³´ë‹¤ëŠ” ì¢…ë˜ ì‹¤ì—…ì í†µê³„ì—ì„œ" \
    " ì¡íˆì§€ ì•Šë˜ ë¹„ê²½ì œí™œë™ì¸êµ¬ ì¤‘ ìƒë‹¹ìˆ˜ê°€ êµ¬ì§í™œë™ì— ë‚˜ì„  ê²ƒì— ë” í° ì˜í–¥ì„ ë°›ì€ ê²ƒìœ¼ë¡œ í’€ì´ëœë‹¤.* (ê¸°ì‚¬ ì›ë¬¸ ì¤‘)")
    st.write('ì´ê´‘í˜¸ ê¸°ì. "8ì›” ê³ ìš©ì‚¬ì • ìµœì•…â€¦ì‹ ê·œ ì·¨ì—… 3000ëª… ì¦ê°€ ê·¸ì³(ì¢…í•©)", 2018ë…„ 09ì›” 12ì¼')
    st.write("https://www.asiae.co.kr/article/2018091208515321517&mobile=Y")
    st.markdown('*ë¹ˆí˜„ì¤€ í†µê³„ì²­ ê³ ìš©í†µê³„ê³¼ì¥ì€ "ê³ ìš©ìœ ë°œíš¨ê³¼ê°€ ë†’ì€ ìë™ì°¨Â·ì¡°ì„ ì—… ë¶€ì§„ì´' \
    ' ê³„ì†ë˜ë©´ì„œ ë„ì†Œë§¤ì—… ë“± ì—°ê´€ ì‚°ì—…ì—ë„ ì˜í–¥ì„ ë¯¸ì³ ì·¨ì—…ì ìˆ˜ê°€ ë§ì´ ë‘”í™”í•œ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤"ê³  ë§í–ˆë‹¤.*(ê¸°ì‚¬ ì›ë¬¸ ì¤‘)')
    st.write('êµ¬ì •ëª¨ ê¸°ì. "í•œêµ­ ì‹¤ì—…ë¥  OECDë³´ë‹¤ ë‚®ì§€ë§Œ ê¸‰ì† ì•…í™”â€¦21ë…„ë§Œì˜ ìµœê³ ", 2021ë…„ 03ì›” 14ì¼')
    st.write("https://www.yna.co.kr/view/AKR20210312125800009")
    st.markdown('*í•œêµ­ì˜ 1ì›” ì‹¤ì—…ë¥ ì€ 5.4%ë¡œ ì „ì›”ë³´ë‹¤ 0.9%í¬ì¸íŠ¸' \
    ' ì•…í™”í•˜ë©´ì„œ 1999ë…„ 10ì›” ì´í›„ ìµœê³ ì¹˜ë¥¼ ê¸°ë¡í–ˆë‹¤.í•œêµ­ì˜ ì‹¤ì—…ë¥ ì€' \
    ' ì‘ë…„ 9ì›”ë¶€í„° ì•…í™” ê¸°ì¡°ë¥¼ ë³´ì—¬ì™”ë‹¤.ë‹¤í–‰ì´ë¼ë©´ ì‹¤ì—…ë¥ ì˜ ì ˆëŒ€ì ì¸ ìˆ˜ì¤€ì€' \
    ' í†µê³„ê°€ ì§‘ê³„ëœ OECD íšŒì›êµ­ 27ê°œêµ­ ì¤‘ 18ìœ„ë¡œ ìƒëŒ€ì ìœ¼ë¡œëŠ” ë‚®ì€ í¸ì´ë¼ëŠ” ì ì´ë‹¤.*(ê¸°ì‚¬ ì›ë¬¸ ì¤‘)')
    st.subheader("íŠ¹ì´ì ì´ ì˜¨ ì‹œê¸°ì˜ ì›ì¸ ìš”ì•½")
    st.markdown("""
            - 2010ë…„ 1ì›”: ê¸°ì¡´ ì‹¤ì—…ì í†µê³„ì— ì¡íˆì§€ ì•Šë˜ ëŒ€ìƒì´ êµ¬ì§í™œë™ì„ í–ˆê¸° ë•Œë¬¸
            - 2018ë…„ 8ì›”: íŠ¹ì • ì‚°ì—…ì˜ ë¶ˆí™©
            - 2021ë…„ 1ì›”: ì½”ë¡œë‚˜(ì „ì„¸ê³„ì  ë™ì¼)
                """)
    df = pd.DataFrame(fired)
    # ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
    df['date'] = pd.to_datetime(df['date'])
    # 'year' ì»¬ëŸ¼ ìƒì„±
    df['year'] = df['date'].dt.year
    # ë…„ë„ë³„ í‰ê·  ê³„ì‚°
    yearly_avg = df.groupby('year')['rate'].mean().reset_index()
    st.subheader("ğŸ“Š ë…„ë„ë³„ í‰ê·  ì‹¤ì—…ë¥ ")
    c4 = px.bar(data_frame=yearly_avg, x="year", y ="rate")
    st.plotly_chart(c4)
    st.subheader("â“ ë…„ë„ë³„ ì‹¤ì—½ë¥ ê³¼ ì˜ì¡´ë„ì˜ ì–‘ìƒì„ ë¹„êµí•´ë³´ì ")


def tip():
    st.header("ğŸ’¡ ìŠ¤ë§ˆíŠ¸í° ê³¼ì˜ì¡´ íƒˆì¶œ íŒ: ë””ì§€í„¸ ë””í†¡ìŠ¤")
    st.markdown("---")
    
    st.subheader("ì¼ìƒì—ì„œ ì‹¤ì²œí•˜ëŠ” 5ê°€ì§€ ìŠµê´€")
    st.write("ìŠ¤ë§ˆíŠ¸í°ìœ¼ë¡œë¶€í„° ììœ ë¡œì›Œì§€ê¸° ìœ„í•œ ê°„ë‹¨í•˜ì§€ë§Œ íš¨ê³¼ì ì¸ ìƒí™œ ìŠµê´€ì…ë‹ˆë‹¤.")
    st.write("")
    
    st.markdown("#### 1. ì•Œë¦¼ ê´€ë¦¬: ë°©í•´ ìš”ì†Œë¥¼ ì°¨ë‹¨í•˜ì„¸ìš”.")
    st.image("https://buildfire.com/wp-content/uploads/2024/09/why-users-mute-push-notifications-1.jpg")
    st.write("- **ë¶ˆí•„ìš”í•œ ì•± ì•Œë¦¼**ì„ ëª¨ë‘ ë„ê³ , ê¼­ í•„ìš”í•œ ì „í™”ë‚˜ ë©”ì‹œì§€ë§Œ ë‚¨ê¹ë‹ˆë‹¤.")

    st.markdown("#### 2. ê³µê°„ ë¶„ë¦¬: ì†ì´ ë‹¿ì§€ ì•ŠëŠ” ê³³ì— ë‘ì„¸ìš”.")
    st.image("https://thumbs.dreamstime.com/b/device-free-zone-icon-text-stop-using-smartphone-digital-devices-detox-creativity-family-fun-community-bonding-208768843.jpg")
    st.write("- ì‹ì‚¬ ì‹œê°„ì´ë‚˜ **ì·¨ì¹¨ ì‹œ**ì—ëŠ” ìŠ¤ë§ˆíŠ¸í°ì„ ì¹¨ì‹¤ ë°– ê±°ì‹¤ì´ë‚˜ ë¶€ì—Œì— ë‘¡ë‹ˆë‹¤. (ë””ì§€í„¸ ê¸ˆì‹)")
    
    st.markdown("#### 3. ì‹œê°„ ì œí•œ ì„¤ì •: ì‚¬ìš© ì‹œê°„ì„ ëˆˆìœ¼ë¡œ í™•ì¸í•˜ì„¸ìš”.")
    st.image("https://cdn.osxdaily.com/wp-content/uploads/2018/11/set-time-limit-social-media-use-ios-sceen-time.jpg")
    st.write("- 'ë™ì˜ìƒ'ê³¼ ê°™ì´ íŠ¸ë˜í”½ ë¹„ì¤‘ì´ ë†’ì€ ì•±ì€ **í•˜ë£¨ ìµœëŒ€ ì‚¬ìš© ì‹œê°„**ì„ ì„¤ì •í•˜ì—¬ ì œí•œí•©ë‹ˆë‹¤.")
    
    st.markdown("#### 4. ìƒˆë¡œìš´ ì·¨ë¯¸: ëŒ€ì²´ í™œë™ì„ ì°¾ìœ¼ì„¸ìš”.")
    st.image("https://static.vecteezy.com/system/resources/thumbnails/002/987/395/small/various-hobbies-and-professions-icons-collection-vector.jpg")
    st.write("- ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš©ì„ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” **ë…ì„œ, ìš´ë™, ê·¸ë¦¼ ê·¸ë¦¬ê¸°** ë“± ì˜¤í”„ë¼ì¸ í™œë™ì„ ì‹œì‘í•©ë‹ˆë‹¤.")
    
    st.markdown("#### 5. ìŠ¤í¬ë¦° íƒ€ì„ í™•ì¸: ê°ê´€ì ì¸ í˜„ì‹¤ì„ ë§ˆì£¼í•˜ì„¸ìš”.")
    st.image("https://static.vecteezy.com/system/resources/previews/029/917/318/non_2x/screen-time-time-control-on-smartphone-stock-illustration-vector.jpg")
    st.write("- ìŠ¤ë§ˆíŠ¸í°ì˜ **'ìŠ¤í¬ë¦° íƒ€ì„'** ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ ìì‹ ì´ ì–¼ë§ˆë‚˜ ë§ì€ ì‹œê°„ì„ ì¼ëŠ”ì§€ ê°ê´€ì ìœ¼ë¡œ í™•ì¸í•˜ê³  ê²½ê°ì‹¬ì„ ê°€ì§‘ë‹ˆë‹¤.")
    
    st.markdown("---")
    st.subheader("ğŸŒ¿ ì‚¶ì˜ ê· í˜•ì„ ë˜ì°¾ìœ¼ì„¸ìš”.")
    st.image("https://www.shutterstock.com/shutterstock/photos/1643401516/display_1500/stock-vector-internet-addiction-and-digital-detox-infographic-what-are-the-effects-on-our-bodies-and-how-to-1643401516.jpg", caption="ë””ì§€í„¸ ë””í†¡ìŠ¤ë¡œ ì°¾ëŠ” í‰í™”")

def helper():
    st.header("ğŸ’ ìƒë‹´ ì„¼í„° ì•ˆë‚´")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.write("## ğŸ‘©â€âš•ï¸ìŠ¤ë§ˆíŠ¸ ì‰¼ ì„¼í„°")
    st.write("#### ì „êµ­ì˜ ìŠ¤ë§ˆíŠ¸ì‰¼ì„¼í„°ë¥¼ í†µí•´ ì˜ˆë°©êµìœ¡, ê°€ì •ë°©ë¬¸ìƒë‹´, ìº í˜ì¸" \
    " ë“± ì¸í„°ë„·Â·ìŠ¤ë§ˆíŠ¸í° ê³¼ì˜ì¡´ ë¬¸ì œë¥¼ í•´ì†Œí•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ì •ì±…ê³¼ ì‚¬ì—…ì„ ì¶”ì§„í•˜ê³  ìˆìŠµë‹ˆë‹¤.")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.subheader("ğŸ”½ëˆ„ë¦¬ì§‘ ë§í¬")
    st.write("https://www.iapc.or.kr/")
    st.image("help.jpg")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.subheader("ğŸ”½ìŠ¤ë§ˆíŠ¸í° ê³¼ì˜ì¡´ì— ëŒ€í•œ ì´í•´ ë° ìŠ¤ë§ˆíŠ¸ì‰¼ì„¼í„° ì†Œê°œì˜ìƒ(ê³µì‹ìœ íŠœë¸Œ)")
    st.video("https://www.youtube.com/watch?v=XKdl-iSC9wU")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.write("### ğŸ—ºï¸ ì„œìš¸ìŠ¤ë§ˆíŠ¸ì‰¼ì„¼í„° ìœ„ì¹˜ğŸ“")   
    # ì§€ë„ ìƒì„±
    m = folium.Map(location=[37.568962, 126.978815], zoom_start=13)

    # ë§ˆì»¤ ì¶”ê°€
    folium.Marker([37.568962, 126.978815], tooltip="ì„œìš¸ìŠ¤ë§ˆíŠ¸ì‰¼ì„¼í„°").add_to(m)

    # ìŠ¤íŠ¸ë¦¼ë¦¿ì— ì§€ë„ í‘œì‹œ
    st_folium(m, width=700, height=500)



def show_content_usage():
    st.header("ğŸ“Š ì½˜í…ì¸  ìœ í˜•ë³„ íŠ¸ë˜í”½ í˜„í™© ë¶„ì„(2015ë…„ ~ 2025ë…„)")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    df = pd.read_csv("ì½˜í…ì¸ _ìœ í˜•ë³„_íŠ¸ë˜í”½_í˜„í™©_ìµœì¢….csv", encoding='cp949')

    st.subheader("ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°")
    st.dataframe(df)

    usage_summary = (
        df.groupby('ì½˜í…ì¸ ìœ í˜•', as_index=False)['ì ìœ ìœ¨(%)']
        .sum()
        .sort_values(by='ì ìœ ìœ¨(%)', ascending=False)
    )

    fig = px.bar(
        usage_summary,
        x='ì½˜í…ì¸ ìœ í˜•',
        y='ì ìœ ìœ¨(%)',
        title='ì½˜í…ì¸  ìœ í˜•ë³„ ì´ íŠ¸ë˜í”½ (TB)',
        color='ì½˜í…ì¸ ìœ í˜•',
        text='ì ìœ ìœ¨(%)'
    )
    fig.update_layout(xaxis_title='ì½˜í…ì¸  ìœ í˜•', yaxis_title='ì´ ì ìœ ìœ¨(%)', showlegend=False)
    st.plotly_chart(fig)

    top_type = usage_summary.iloc[1]
    st.markdown("---")
    st.subheader("ìš”ì•½")
    st.write(
        f"ê°€ì¥ ë§ì€ íŠ¸ë˜í”½ì„ ì‚¬ìš©í•˜ëŠ” ì½˜í…ì¸  ìœ í˜•ì€ **{top_type['ì½˜í…ì¸ ìœ í˜•']}**ì´ë©°, "
        f"ì´ íŠ¸ë˜í”½ì€ **{top_type['ì ìœ ìœ¨(%)']:.1f} TB** ì…ë‹ˆë‹¤."
    )
    st.write("ì´ ìœ í˜•ì€ ì‚¬ìš©ìë“¤ì´ ê°€ì¥ ë§ì´ ì´ìš©í•˜ëŠ” ì£¼ìš” ì½˜í…ì¸ ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
    # -------------------------------------------
    st.markdown("---")
    # -------------------------------------------
    st.write("### ğŸ”½ ë©”ì¸ í™”ë©´ì˜ ë‰´ìŠ¤ ìë£Œì™€ ë¹„êµí•˜ê¸°")
    st.image("news.jpg")



st.sidebar.title('ğŸ“± ìŠ¤ë§ˆíŠ¸í° ê³¼ì˜ì¡´ í…ŒìŠ¤íŠ¸')

# ì²´í¬ë°•ìŠ¤ í•­ëª©ë“¤
q1 = st.sidebar.checkbox('ì´ìš©ì‹œê°„ì„ ì¤„ì¼ë ¤ê³  í•´ë„ í˜ë“¤ë‹¤')
q2 = st.sidebar.checkbox('ì¼ìƒìƒí™œì— ì§€ì¥ì„ ëŠë‚€ ì ì´ ìˆë‹¤')
q3 = st.sidebar.checkbox('ì´ìš©ì‹œê°„ì„ ì§€í‚¤ëŠ” ê²ƒì´ ì–´ë µë‹¤')
q4 = st.sidebar.checkbox('ìŠ¤ë§ˆíŠ¸í°ì´ ì˜†ì— ìˆìœ¼ë©´ ì§‘ì¤‘ì´ ì–´ë µë‹¤')
q5 = st.sidebar.checkbox('ìŠ¤ë§ˆíŠ¸í° ì´ìš© ë•Œë¬¸ì— íƒ€ì¸ê³¼ ê°ˆë“±ì„ ë¹šì€ ì ì´ ìˆë‹¤')

# ì²´í¬ëœ í•­ëª© ìˆ˜ ê³„ì‚°
checked_count = sum([q1, q2, q3, q4, q5])

# ì¡°ê±´ì— ë”°ë¼ ìƒˆë¡œìš´ ë©”ë‰´ ì¶”ê°€
if checked_count >= 3:
    st.sidebar.markdown("---")
    st.sidebar.subheader("ğŸ“Š ê²°ê³¼ ë³´ê¸°")
    option = st.sidebar.selectbox(
    "ë‹¤ìŒ ì¤‘ ì›í•˜ëŠ” í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”:",
    ("ê³¼ì˜ì¡´ ìœ„í—˜ë„ ë¶„ì„", "ì½˜í…ì¸  ì´ìš© í˜„í™© ë¶„ì„", "ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš© ì¤„ì´ê¸° íŒ", "ìƒë‹´ ì„¼í„° ì•ˆë‚´"))

    if option == 'ì½˜í…ì¸  ì´ìš© í˜„í™© ë¶„ì„':
        show_content_usage()
    if option == 'ê³¼ì˜ì¡´ ìœ„í—˜ë„ ë¶„ì„':
        show_anl()
    elif option == 'ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš© ì¤„ì´ê¸° íŒ':
        tip()
    elif option == 'ìƒë‹´ ì„¼í„° ì•ˆë‚´':
        helper()
    else:
        st.header("")
else:
     show_main()